11
Russian Technological Journal. 2024;12(6):7–19
С.В. Кочергин 
и др.
Кибербезопасность смарт-сетей: сравнение подходов машинного обучения  
для обнаружения аномалий
Мультифрактальный анализ  
и метод Isolation Forest
Фрактальные методы позволяют выявлять ано-
малии в  данных, которые могут указывать на  из-
менение состояния системы или наличие внешних 
воздействий. Это делает их полезными для монито-
ринга и диагностики различных процессов [15–17].
Применим дискретное вейвлет-преобразование 
для напряжения и  вычислим мультифрактальные 
признаки – среднее значение и дисперсию абсолют-
ных значений коэффициентов. Вектор этих призна-
ков будем использовать в модели Isolation Forest [18] 
для обнаружения аномалий.
Пусть x(t)  – временной ряд, представляющий 
данные (например, временной ряд напряжения). Для 
анализа временного ряда используется дискретное 
вейвлет-преобразование, которое разлагает сигнал 
на несколько уровней детализации.
Вейвлет-преобразование Wx сигнала x(t) на уров-
не j можно записать как:
	
Wx(t, j) = Σt x(t)ψj,k(t),
(1)
где ψj,k(t) – функция-вейвлет, сдвинутая и масштаби-
рованная версия материнского вейвлета.
Для каждого уровня разложения j получаем на-
бор коэффициентов cj, которые описывают различ-
ные временные масштабы сигнала:
	
cj = Wx(t, j).
(2)
На каждом уровне j вейвлет-разложения вычис-
ляются среднее значение и  дисперсия абсолютных 
значений коэффициентов cj:
	
,
1
1
|
|,
j
N
j
j k
j k
N



μ
c

(3)
	
2
2
,
1
1
(|
|
) ,
j
N
j
j k
j
j k
N




σ
c
μ

(4)
где Nj – количество коэффициентов на уровне j. 
Эти признаки составляют вектор признаков для 
каждого временного ряда:
	
2
2
2
1
1
2
2
[
,
,
,
, ...,
,
].
m
m
 µ σ
µ
σ
µ
σ
features

(5)
Пусть Fi – вектор мультифрактальных признаков 
для i-го временного ряда, тогда множество призна-
ков для всех временных рядов можно записать как 
матрицу:
	
F = [F1, F2, …, Fn]T.
(6)
Проведем обучение модели Isolation Forest [18] 
на матрице признаков F, чтобы выявить аномалии. 
При этом модель строит несколько деревьев ре-
шений, в  которых данные разрезаются на  основе 
случайно выбранных признаков, и пытается изоли-
ровать аномальные точки данных с  минимальной 
глубиной дерева.
Аномальные оценки  (scores) для каждого вре-
менного ряда вычисляются с использованием функ-
ции принятия решений:
	
Si = decision_function(Fi),
(7)
где Si – оценка аномалии для i-го временного ряда.
Аномальная оценка Si используется для опреде-
ления степени отклонения временного ряда от нор-
мального состояния. Низкие значения Si указывают 
на сильную аномалию, тогда как высокие значения 
Si соответствуют нормальному поведению.
На основе изложенных теоретических принци-
пов была разработана компьютерная программа. С ее 
помощью и использованием модели Isolation Forest, 
основанной на мультифрактальных признаках, созда-
на тепловая карта аномалий (рис. 2). Использование 
тепловых карт для визуализации аномалий обоснова-
но тем, что они позволяют наглядно продемонстриро-
вать повторяющиеся паттерны и отделить нормаль-
ные события от кибератак и аварийных режимов.
На тепловой карте горизонтальная ось представ-
ляет временные шаги (от 0 до 1000), отображающие 
последовательные измерения данных во  времени, 
а вертикальная ось отражает оценки аномалий, пред-
сказанные моделью. Градиентная шкала варьируется 
от черного, указывающего на высокие аномальные 
оценки (низкая вероятность нормальности), до бело-
го, который свидетельствует о  низких аномальных 
оценках (высокая вероятность нормальности).
Анализ тепловой карты
1.	Период равен 0–500  с. Большая часть данных 
в этом периоде окрашена в белый цвет, что сви-
детельствует о низких аномальных оценках. Это 
указывает на то, что модель классифицирует эти 
данные как нормальные.
2.	Период около временной отметки равен 500  с. 
В  этом периоде наблюдается узкая черная по-
лоса, что соответствует высокому аномальному 
скору. 
3.	Эта черная полоса явно указывает на киберата-
ку, которая была синтезирована для имитации 
резкого отклонения от  нормы. Модель успеш-
но идентифицировала это отклонение, что под-
тверждается наличием черного участка на  те-
пловой карте.
